<div class="row">
  <div class="small-12 columns">
    <h1>Routine <%= @routine.name %></h1>
    <% @all_routines.each do |routine| %>
      <p class="text-right">
        <%= link_to "Switch to Routine #{routine.name}", new_workout_path(routine_id: routine.id) %>
      </p>
    <% end %>
    <%= form_for @workout do |f| %>
      <%= f.hidden_field :routine_id %>
      <fieldset>
        <legend><%= Workout.human_attribute_name(:body_weight) %></legend>
        <%= f.number_field :body_weight %>
      </fieldset>
      <% @workout.exercise_sets.group_by(&:exercise).each do |exercise, exercise_sets| %>
        <fieldset>
          <legend><%= exercise.name %></legend>
          <% exercise_sets.each.with_index(1) do |set, index| %>
            <%= f.fields_for :exercise_sets, set do |s| %>
              <fieldset name="<%= exercise.slug %>-<%= index %>">
                <legend>Set</legend>
                <div class="row">
                  <div class="small-6 columns">
                    <%= s.label :target_repetitions %>
                    <%= s.number_field :target_repetitions %>
                  </div>

                  <div class="small-6 columns">
                    <%= s.label :target_weight %>
                    <%= s.number_field :target_weight %>
                  </div>
                </div>
                <p class="text-right"><a class="skip" href="#">skip</a></p>
                <%= s.hidden_field :exercise_id %>
              </fieldset>
            <% end %>
          <% end %>
        </fieldset>
      <% end %>
      <%= f.submit "Start", class: "button round right" %>
    <% end %>
  </div>
</div>

<script type="text/javascript" charset="utf-8">
var ready = function() {
  window.currentView = new Stronglifters.NewWorkoutView({ el: $('#new_workout') });
};
$(document).ready(ready);
$(document).on('page:load', ready);
</script>
