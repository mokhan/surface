#!/bin/env ruby

# bin/rails runner -e development bin/yelp
#url='https://api.yelp.com/v2/search/?term=gym&location=Calgary&sort=2&limit=20&cc=CA&category_filter=gyms'
#curl $url
Gym.delete_all
Location.delete_all
cities = ['Calgary', 'Edmonton', 'Portland', 'Victoria', 'Anaheim', 'San Diego', 'Seattle']
cities.each do |city|
  (1..5).each do |page|
    puts "Searching #{city}, page: #{page}"
    gyms = Gym.search_yelp(q: 'gym', city: city, page: page)
    puts "  Found: #{gyms.count}, #{gyms.map(&:name)}"
    gyms.each(&:save!)
  end
end
